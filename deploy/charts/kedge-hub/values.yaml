# -- Image settings
image:
  hub:
    repository: ghcr.io/faroshq/kedge-hub
    tag: ""  # defaults to .Chart.AppVersion
    pullPolicy: IfNotPresent
  kcp:
    repository: ghcr.io/kcp-dev/kcp
    tag: "v0.30.0"
    pullPolicy: IfNotPresent

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

# -- kcp settings (embedded etcd, single instance)
kcp:
  featureGates: "WorkspaceMounts=true"
  extraArgs: []
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      memory: 1Gi

# -- kedge-hub settings
hub:
  # Required: external URL for kubeconfig generation and OIDC callbacks
  hubExternalURL: ""
  listenAddr: ":8443"
  devMode: false
  # Static bearer token for admin access (bypasses OIDC entirely. Example: openssl rand -base64 32)
  staticAuthToken: ""
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      memory: 512Mi
  # -- TLS configuration for hub serving
  tls:
    # Provide an existing Secret with tls.crt and tls.key
    existingSecret: ""
    # Auto-generate self-signed cert (dev/local only)
    selfSigned:
      enabled: true
      dnsNames: []
      ipAddresses:
        - "127.0.0.1"
    # Use cert-manager to issue a certificate (recommended for production)
    certManager:
      enabled: false
      issuerRef:
        name: ""
        kind: ClusterIssuer
        group: cert-manager.io
      dnsNames: []

# -- Identity provider (OIDC) settings (see docs/idp.md)
idp:
  # Required: OIDC issuer URL reachable by hub and end-user browsers
  issuerURL: ""
  clientID: "kedge"
  clientSecret: ""

# -- kcp data PVC
persistence:
  size: 10Gi
  storageClass: ""
  accessModes:
    - ReadWriteOnce

# -- Service configuration
service:
  type: ClusterIP
  hub:
    port: 8443

# -- Ingress (optional, passthrough to hub TLS)
ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts: []
  #  - host: kedge.example.com
  #    paths:
  #      - path: /
  #        pathType: ImplementationSpecific

nodeSelector: {}
tolerations: []
affinity: {}
podAnnotations: {}
podSecurityContext:
  fsGroup: 65534
securityContext:
  runAsNonRoot: true
  runAsUser: 65534
